

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Convolution Group &mdash; embARC Machine Learning Inference Library 1.00a documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Pooling Group" href="pooling_group.html" />
    <link rel="prev" title="Kernel Functions" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> embARC Machine Learning Inference Library
          

          
          </a>

          
            
            
              <div class="version">
                1.00a
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../initial/index.html">Definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../initial/index.html#revision-history">Revision history</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mli_api_desc/index.html">Machine Learning Interface Library API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Kernel Functions</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Convolution Group</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#convolution-2d">Convolution 2D</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#function-configuration-structure">Function Configuration Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#general-api">General API</a></li>
<li class="toctree-l4"><a class="reference internal" href="#function-specializations">Function Specializations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conditions-for-applying-the-function">Conditions for Applying the Function</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#depth-wise-convolution">Depth-wise Convolution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#function-configuration-structure-1">Function Configuration Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#general-api-1">General API</a></li>
<li class="toctree-l4"><a class="reference internal" href="#function-specializations-1">Function Specializations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conditions-for-applying-the-function-1">Conditions for Applying the Function</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pooling_group.html">Pooling Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="common_group.html">Common Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="transform_group.html">Transform Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="element_wise_group.html">Elementwise Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_manipulation_group.html">Data Manipulation Group</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../helper_func_desc/index.html">Helper Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../final/references.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">embARC Machine Learning Inference Library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Kernel Functions</a> &raquo;</li>
        
      <li>Convolution Group</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/kernel_func_desc/convolution_group.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="convolution-group">
<h1>Convolution Group<a class="headerlink" href="#convolution-group" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div>Convolution group of functions convolve input features with a set of
trained filters. Typically these are multi-dimensional tensors.</div></blockquote>
<div class="section" id="convolution-2d">
<span id="cnvl-2d"></span><h2>Convolution 2D<a class="headerlink" href="#convolution-2d" title="Permalink to this headline">¶</a></h2>
<div class="figure" id="id5">
<span id="f-cnvl-2d-op"></span><img alt="../_images/image104.jpg" src="../_images/image104.jpg" />
<p class="caption"><span class="caption-number">Fig. 1 </span><span class="caption-text">2D-Convolution Operation</span></p>
<div class="legend">
<p>This kernel implements a general 2D convolution operation. It applies
each filter of weights tensor to each framed area of the size of
input tensor</p>
<p>Input and output feature maps are three-dimensional tensor even if one of
dimensions is equal to 1. Input shape includes height, width, and
depth (channels) according to used data layout (see <a class="reference internal" href="../mli_api_desc/general_considerations.html#data-muldim"><span class="std std-ref">Data Layout of Multidimensional Feature Maps</span></a>).</p>
<p>Filter (also referred as kernel in other sources) consists of two
separate tensors:</p>
<ul class="simple">
<li><strong>weights tensor</strong>: Weights is 4-dimensional tensor. The first
dimension of weights tensor is the output depth (might be considered as
the number of filters). The rest dimensions includes height, width
and kernel depth in order of particular layout. Ensure that the
layout and depth dimensions of Input and weights tensors are same.</li>
<li><strong>Biases tensor</strong>: Biases is one-dimensional tensor of shape
[output_depth].</li>
</ul>
</div>
</div>
<blockquote>
<div><p>In processing, perception window for applying the filter (see <a class="reference internal" href="#f-cnvl-2d-op"><span class="std std-numref">Fig. 1</span></a>
) moves along dimensions according to stride parameters.</p>
<p>To implicitly insert additional points to sides of feature map
(considering only width and height dimensions), ensure that you set
the padding parameters. Padding influences how feature map is divided
into patches for applying kernels because values of padded points are
always zero.</p>
<p>For example, in a HWC data layout, if input fmap is [Hi, Wi, Ci] and
kernel is [Co, Hk, Wk, Ci], the output fmap is [Ho, Wo, Co] matrix
where the output dimensions Ho and Wo are calculated dynamically
depending on convolution parameters (such as padding and stride)
inputs shape.</p>
<p>For more details on calculations see convolution part of entry [3] in <a class="reference internal" href="../final/references.html#refs"><span class="std std-ref">References</span></a>.</p>
<p>ReLU activation function might be applied to result of convolution. The
following types of ReLU activations are supported (for more info see
<a class="reference internal" href="transform_group.html#relu"><span class="std std-ref">ReLU</span></a>):</p>
<ul class="simple">
<li>RELU_NONE</li>
<li>RELU_GEN</li>
<li>RELU_1</li>
<li>RELU_6</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Ensure that input and output
tensors do not point to
overlapped memory regions,
otherwise the behavior is
undefined.</p>
</div>
<div class="section" id="function-configuration-structure">
<span id="fn-conf-struct"></span><h3>Function Configuration Structure<a class="headerlink" href="#function-configuration-structure" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="32%" />
<col width="37%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Definition</strong></td>
<td colspan="2"><div class="code c first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">struct</span> <span class="p">{</span>
   <span class="n">uint8_t</span> <span class="n">stride_width</span><span class="p">;</span>
   <span class="n">uint8_t</span>  <span class="n">stride_height</span><span class="p">;</span>
   <span class="n">uint8_t</span> <span class="n">padding_left</span><span class="p">;</span>
   <span class="n">uint8_t</span> <span class="n">padding_right</span><span class="p">;</span>
   <span class="n">uint8_t</span> <span class="n">padding_top</span><span class="p">;</span>
   <span class="n">uint8_t</span>  <span class="n">padding_bottom</span><span class="p">;</span>
   <span class="n">mli_relu_cfg</span> <span class="n">relu</span><span class="p">;</span>
<span class="p">}</span> <span class="n">mli_conv2d_cfg</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Fields</strong></td>
<td><code class="docutils literal notranslate"><span class="pre">stride_width</span></code></td>
<td>Stride of filter across
width dimension of input</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">stride_height</span></code></td>
<td>Stride (step) of filter
across height dimension
of input</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">padding_left</span></code></td>
<td>Number of zero points
implicitly added to the
leftside of input (width
dimension)</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">padding_right</span></code></td>
<td>Number of zero points
implicitly added to
the right side of input
(width dimension).</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">padding_top</span></code></td>
<td>Number of zero points
implicitly added to the
upper side of input
(height dimension).</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">padding_bottom</span></code></td>
<td>Number of zero points
implicitly added to the
bottom side of input
(height dimension).</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">relu</span></code></td>
<td>Type of ReLU activation
applied to output values</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="general-api">
<h3>General API<a class="headerlink" href="#general-api" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Interface of all specializations are the same and described as follows:</p>
<p></p>
</div></blockquote>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Prototype</strong></td>
<td colspan="2"><div class="code c first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mli_status</span>  <span class="n">mli_krn_conv2d_</span><span class="o">&lt;</span><span class="n">layout</span><span class="o">&gt;</span><span class="n">_</span>
<span class="o">&lt;</span><span class="n">data_type</span><span class="o">&gt;</span><span class="p">[</span><span class="n">_specialization</span><span class="p">](</span>
<span class="n">const</span> <span class="n">mli_tensor</span> <span class="o">*</span><span class="ow">in</span><span class="p">,</span>
<span class="n">const</span> <span class="n">mli_tensor</span> <span class="o">*</span><span class="n">weights</span><span class="p">,</span>
<span class="n">const</span> <span class="n">mli_tensor</span> <span class="o">*</span><span class="n">bias</span><span class="p">,</span>
<span class="n">const</span> <span class="n">mli_conv2d_cfg</span> <span class="o">*</span><span class="n">cfg</span><span class="p">,</span>
<span class="n">mli_tensor</span> <span class="o">*</span><span class="n">out</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Parameters</strong></td>
<td><code class="docutils literal notranslate"><span class="pre">in</span></code></td>
<td>[IN] Pointer to input
feature map tensor</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">weights</span></code></td>
<td>[IN] Pointer to
convolution filters
weights tensor</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">bias</span></code></td>
<td>[IN] Pointer to
convolution filters
biases tensor</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">cfg</span></code></td>
<td>[IN] Pointer to
convolution
parameters structure</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">out</span></code></td>
<td>[OUT] Pointer to
output feature map
tensor. Result is
stored here</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="function-specializations">
<h3>Function Specializations<a class="headerlink" href="#function-specializations" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>There are about 70 specializations for the primitive, assuming
various combinations of inputs parameters. Convolution primitive
follows naming convention for specializations (see <a class="reference internal" href="../mli_api_desc/general_considerations.html#spec-fns"><span class="std std-ref">Specialized Functions</span></a>).
The <code class="docutils literal notranslate"><span class="pre">mli_krn_conv2d_spec_api.h</span></code> header file contains declarations of
all specializations for the primitive.</div></blockquote>
<p></p>
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Function</strong></th>
<th class="head"><strong>Description</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td colspan="2"><em>CHW Data Layout</em></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">mli_krn_conv2d_chw_fx8</span></code></td>
<td>Switching function; 8bit FX
tensors; Delegates calculations
to suitable specialization or
generic function.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">mli_krn_conv2d_chw_fx16</span></code></td>
<td><p class="first">Switching function; 16bit FX
tensors;</p>
<p class="last">Delegates calculations to
suitable specialization or
generic function.</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">mli_krn_conv2d_chw_fx8w16d</span></code></td>
<td>General function; FX tensors
(8bit weights and biases, 16 bit
input and output)</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">mli_krn_conv2d_chw_fx8_generic</span></code></td>
<td>General function; 8bit FX tensors</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">mli_krn_conv2d_chw_fx16_generic</span></code></td>
<td>General function; 16bit FX
tensors</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">mli_krn_conv2d_chw_fx8_[spec]</span></code></td>
<td>Specialization function*; 8bit FX
tensors</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">mli_krn_conv2d_chw_fx16_[spec]</span></code></td>
<td>Specialization function*; 16bit
FX tensors</td>
</tr>
<tr class="row-even"><td><em>HWC Data Layout</em></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">mli_krn_conv2d_hwc_fx8</span></code></td>
<td>General function; 8bit FX tensors</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">mli_krn_conv2d_hwc_fx16</span></code></td>
<td>General function; 16bit FX
tensors</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">mli_krn_conv2d_hwc_fx8w16d</span></code></td>
<td>General function; FX tensors
(8bit weights and biases, 16 bit
input and output)</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">*For specialization functions, backward compatibility between different releases cannot be guaranteed. The General functions call the available specializations when possible.</p>
</div>
</div>
<div class="section" id="conditions-for-applying-the-function">
<h3>Conditions for Applying the Function<a class="headerlink" href="#conditions-for-applying-the-function" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Ensure that you satisfy the following conditions before applying the
function:</p>
<ul class="simple">
<li>Input, Weights and Bias tensors must be valid (see <a class="reference internal" href="../mli_api_desc/general_considerations.html#mli-tns-struct"><span class="std std-ref">mli_tensor Structure</span></a>)</li>
<li>Before processing, the output tensor must contain a valid pointer to
a buffer with sufficient capacity (enough for result storing). It
also must contain valid element parameter (<code class="docutils literal notranslate"><span class="pre">el_params.fx.frac_bits</span></code>)</li>
<li>Before processing, the output tensor does not have to contain valid
shape, rank and element type fields. These are filled by the
function.</li>
<li>The data layout of Input and weights tensors must be the same. Their
depth (channels) dimension must also be equal.</li>
<li>Bias must be a one-dimensional tensor. Its length must be equal to the
amount of filters (first dimension of weights tensor).</li>
<li><code class="docutils literal notranslate"><span class="pre">padding_top</span></code> and <code class="docutils literal notranslate"><span class="pre">padding_bottom</span></code> parameters must be in range of [0,
weights_height).</li>
<li><code class="docutils literal notranslate"><span class="pre">padding_left</span></code> and <code class="docutils literal notranslate"><span class="pre">padding_right</span></code> parameters must be in range of [0,
weights_width).</li>
<li><code class="docutils literal notranslate"><span class="pre">stride_width</span></code> and <code class="docutils literal notranslate"><span class="pre">stride_height</span></code> parameters must not be equal to 0.</li>
<li><code class="docutils literal notranslate"><span class="pre">weights_width</span></code> and <code class="docutils literal notranslate"><span class="pre">weights_height</span></code> must be less than or equal to the
appropriate dimensions of the input tensor.</li>
<li>Additional restrictions for specialized functions are described in
<a class="reference internal" href="../mli_api_desc/general_considerations.html#spec-fns"><span class="std std-ref">Specialized Functions</span></a>.</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="depth-wise-convolution">
<h2>Depth-wise Convolution<a class="headerlink" href="#depth-wise-convolution" title="Permalink to this headline">¶</a></h2>
<div class="figure" id="id6">
<span id="f-depthwise"></span><img alt="../_images/image107.jpg" src="../_images/image107.jpg" />
<p class="caption"><span class="caption-number">Fig. 2 </span><span class="caption-text">Depth-wise Convolution Operation</span></p>
<div class="legend">
<p>This kernel implements a 2D depth-wise convolution operation applying
each filter channel to each input channel separately. As a result,
output image depth is the same as input image depth.</p>
<p>MLI implementation of depth-wise convolution is compatible with caffe
implementation of convolution layer with group parameter equal to
number of input channels. In comparison with TensorFlow
implementation (<code class="docutils literal notranslate"><span class="pre">tf.nn.depthwise_conv2d</span></code> in python API), this
implementation does not support channel multiplier feature. Therefore,
the last dimension of weights tensor must be equal to 1.</p>
<p>For the example for CHW data layout, if the input feature map is [Ci,
Hi, Wi] and the kernel is [Ci, Hk, Wk,1], the output feature map is
[Ci, Ho, Wo] matrix where the output dimensions Ho and Wo are
calculated dynamically according to convolution parameters (such as
padding and stride) in the same way as for general convolution 2D
kernel (see <a class="reference internal" href="#cnvl-2d"><span class="std std-ref">Convolution 2D</span></a>).</p>
<p>ReLU activation function might be applied to result of convolution. The
following types of ReLU activations are supported (for more info see
<a class="reference internal" href="transform_group.html#relu"><span class="std std-ref">ReLU</span></a>):</p>
<ul class="simple">
<li>RELU_NONE</li>
<li>RELU_GEN</li>
<li>RELU_1</li>
<li>RELU_6</li>
</ul>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Ensure that input and output
tensors do not point to
overlapped memory regions,
otherwise the behavior is
undefined.</p>
</div>
<div class="section" id="function-configuration-structure-1">
<span id="id1"></span><h3>Function Configuration Structure<a class="headerlink" href="#function-configuration-structure-1" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>Depth-wise convolution kernel shares configuration structure with
general convolution 2D kernel. For more information see <a class="reference internal" href="#fn-conf-struct"><span class="std std-ref">Function Configuration Structure</span></a>
section of Convolution 2D function.</div></blockquote>
</div>
<div class="section" id="general-api-1">
<span id="id2"></span><h3>General API<a class="headerlink" href="#general-api-1" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Interface of all specializations are the same and described in
following table.</p>
<p></p>
</div></blockquote>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Prototype</strong></td>
<td colspan="2"><div class="code c first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mli_status</span> <span class="n">mli_krn_depthwise_conv2d_</span>
<span class="o">&lt;</span><span class="n">layout</span><span class="o">&gt;</span><span class="n">_</span><span class="o">&lt;</span><span class="n">data_type</span><span class="o">&gt;</span><span class="p">[</span><span class="n">_specialization</span><span class="p">](</span>
   <span class="n">const</span> <span class="n">mli_tensor</span> <span class="o">*</span><span class="ow">in</span><span class="p">,</span>
   <span class="n">const</span> <span class="n">mli_tensor</span> <span class="o">*</span><span class="n">weights</span><span class="p">,</span>
   <span class="n">const</span> <span class="n">mli_tensor</span> <span class="o">*</span><span class="n">bias</span><span class="p">,</span>
   <span class="n">const</span> <span class="n">mli_conv2d_cfg</span> <span class="o">*</span><span class="n">cfg</span><span class="p">,</span>
   <span class="n">mli_tensor</span> <span class="o">*</span><span class="n">out</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Parameters</strong></td>
<td><code class="docutils literal notranslate"><span class="pre">in</span></code></td>
<td>[IN] Pointer to input
feature map tensor</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">weights</span></code></td>
<td>[IN] Pointer to
convolution filters
weights tensor</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">bias</span></code></td>
<td>[IN] Pointer to
convolution filters
biases tensor</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">cfg</span></code></td>
<td>[IN] Pointer to
convolution
parameters structure</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td><code class="docutils literal notranslate"><span class="pre">out</span></code></td>
<td>[OUT] Pointer to
output feature map
tensor. Result is
stored here</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="function-specializations-1">
<span id="id3"></span><h3>Function Specializations<a class="headerlink" href="#function-specializations-1" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>There are about 70 specializations for the primitive assuming various
combinations of inputs parameters. Depth-wise convolution primitive
follows the naming convention for specializations (see <a class="reference internal" href="../mli_api_desc/general_considerations.html#spec-fns"><span class="std std-ref">Specialized Functions</span></a>).
The header file <code class="docutils literal notranslate"><span class="pre">mli_krn_depthwise_conv2d_spec_api.h</span></code> contains declarations
of all specializations for the primitive.</p>
<p><a class="reference internal" href="#non-spec-func-dw-cnvl"><span class="std std-numref">Table 10</span></a> does not contain specialized functions.
No functions for HWC data layout have been implemented at the moment.
To use depth-wise convolution in this case, ensure that you change weights
and inputs layout beforehand by permute primitive (see <a class="reference internal" href="data_manipulation_group.html#permute"><span class="std std-ref">Permute</span></a>).</p>
</div></blockquote>
<span id="non-spec-func-dw-cnvl"></span><table border="1" class="colwidths-auto docutils" id="id7">
<caption><span class="caption-number">Table 10 </span><span class="caption-text">Non-Specialized Functions for Depth-Wise Convolution</span><a class="headerlink" href="#id7" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>Function</strong></th>
<th class="head"><strong>Description</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">mli_krn_depthwise_conv2d_chw_fx8</span></code></td>
<td>Switching function (see
<a class="reference internal" href="../mli_api_desc/general_considerations.html#fns"><span class="std std-ref">Functions</span></a>); 8bit FX tensors;
Delegates calculations to
suitable specialization or
generic function.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">mli_krn_depthwise_conv2d_chw_fx16</span></code></td>
<td><p class="first">Switching function (see
<a class="reference internal" href="../mli_api_desc/general_considerations.html#fns"><span class="std std-ref">Functions</span></a>); 16bit FX tensors;</p>
<p class="last">Delegates calculations to
suitable specialization or
generic function.</p>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">mli_krn_depthwise_conv2d_chw_fx8w16d</span></code></td>
<td>General function; 8bit FX tensors</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">mli_krn_depthwise_conv2d_chw_fx8_generic</span></code></td>
<td>General function; 16bit FX
tensors</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">mli_krn_depthwise_conv2d_chw_fx16_generic</span></code></td>
<td>Specialization function*; 8bit FX
tensors</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">mli_krn_depthwise_conv2d_chw_fx16_[spec]</span></code></td>
<td>Specialization function*; 16bit
FX tensors</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">*For specialization
functions, backward
compatibility between
different releases cannot be
guaranteed. The General
functions call the available
specializations when possible.</p>
</div>
</div>
<div class="section" id="conditions-for-applying-the-function-1">
<span id="id4"></span><h3>Conditions for Applying the Function<a class="headerlink" href="#conditions-for-applying-the-function-1" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Ensure that you satisfy the following conditions before applying the
function:</p>
<ul class="simple">
<li>Input, Weights and Bias tensors must be valid (see <a class="reference internal" href="../mli_api_desc/general_considerations.html#mli-tns-struct"><span class="std std-ref">mli_tensor Structure</span></a>)</li>
<li>Before processing, the output tensor must contain valid pointer to a
buffer with sufficient capacity (enough for result storing). It
also must contain valid element parameter (<code class="docutils literal notranslate"><span class="pre">el_params.fx.frac_bits</span></code>)</li>
<li>Before processing, the output tensor does not have to contain valid
shape, rank and element type fields. These are filled by function.</li>
<li>Input and weights tensors data layout must be the same. Amount of
weights channels must be 1.</li>
<li>Amount of filters (first dimension of weights tensor) must be equal
to number of input channels.</li>
<li>Bias must be one-dimensional tensor. Its length must be equal to
amount of filters (first dimension of weights tensor)</li>
<li>padding_top and padding_bottom parameters must be in range of [0,
weights_height).</li>
<li><code class="docutils literal notranslate"><span class="pre">padding_left</span></code> and <code class="docutils literal notranslate"><span class="pre">padding_right</span></code> parameters must be in range of [0,
weights_width).</li>
<li><code class="docutils literal notranslate"><span class="pre">stride_width</span></code> and <code class="docutils literal notranslate"><span class="pre">stride_height</span></code> parameters must not be equal to 0.</li>
<li><code class="docutils literal notranslate"><span class="pre">weights_width</span></code> and <code class="docutils literal notranslate"><span class="pre">weights_height</span></code> must be less or equal to appropriate
dimensions of input tensor.</li>
<li>Additional restrictions for specialized functions are described in
section <a class="reference internal" href="../mli_api_desc/general_considerations.html#spec-fns"><span class="std std-ref">Specialized Functions</span></a>.</li>
</ul>
</div></blockquote>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pooling_group.html" class="btn btn-neutral float-right" title="Pooling Group" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Kernel Functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Synopsys, Inc

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>